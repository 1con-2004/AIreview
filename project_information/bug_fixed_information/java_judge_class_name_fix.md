# Java代码判题类名识别问题修复日志

1. [ ✅ ] 发现在提交Java代码到判题系统时，出现"Could not find or load main class temp_xxx"错误

2. { 2025-04-19 } 修改了文件路径为`backend/src/services/judge/sandbox.js`中的`runJava`方法。具体修改内容为：不再简单地使用临时文件名作为Java类名，而是通过正则表达式从Java代码中提取实际的类名。当无法提取到类名时，默认使用"Solution"类名（与preprocessJavaCode方法中创建的默认类名一致）。

3. [ ✅ ] 对于Java判题类名识别问题的解决方案，已经实现以下内容：

- 从Java源文件内容中提取类定义，获取正确的类名
- 当找不到类定义时，使用默认的"Solution"类名
- 确保判题系统运行Java代码时使用正确的类名

# 问题出现原因

在判题系统的实现中，Java代码执行部分存在一个逻辑错误。系统会将用户提交的Java代码保存为临时文件（如temp_1745028165148.java），然后在Docker容器中编译和运行。

原本的代码简单地使用文件名（不带扩展名）作为类名，但这不符合Java的要求。在Java中，公共类的名称必须与文件名相同，而系统的预处理代码会将用户代码封装在一个名为"Solution"的类中（如果用户未提供自己的类定义）。

这导致系统尝试使用"temp_1745028165148"作为类名，而实际编译后的类名可能是"Solution"，造成"ClassNotFoundException"错误。

# 修复步骤

1. 在`runJava`方法中添加代码，读取Java源文件内容
2. 使用正则表达式从源代码中提取类定义
3. 如果找到类定义，使用提取的类名；否则使用默认的"Solution"类名
4. 使用正确的类名执行Java程序

# 测试验证

修复后，系统能够正确识别和使用Java代码中定义的类名，或在未提供类名时使用默认的"Solution"类名，成功解决了"ClassNotFoundException"错误。 